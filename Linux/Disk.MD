# Disk
```
磁盘运行原理
简单来说就是多个盘片之间靠主轴连接，电机带动主轴做旋转运动，通过多个磁头臂的摇摆和磁盘的旋转，磁头就可以在磁盘旋转的过程中就读取到磁盘中存储的各种数据

```
`磁盘的扇区、磁道、柱面`
* 磁道：磁盘的每个盘片被划分为许多同心圆，划分园的线条叫做磁道。
* sector扇区：硬盘的最小存储单位,每个扇区存储512字节,硬盘的盘片被磁道划分成多个扇区。硬盘的读写以扇区为基本单位.
* 柱面：每一个盘片同一大小的同心圆可以看成连在一起的柱面，磁盘在分区的时候最小单位是柱面，每一个盘片的上下面都可以读取数据，每一个磁头，不可以跨盘面读取数据。


`磁盘管理,Linux磁盘管理通常分成五个步骤`
* 添加硬盘
* 做RAID或逻辑卷LVM
* fdisk分区
* mkfs格式化
`格式化的时候，操作系统自动将硬盘分成两个区域。一个是数据区，存放文件数据；另一个是inode区，存放inode所包含的信息。每个inode的大小，一般是128字节或256字节。通常情况下不需要关注单个inode的大小，而是需要重点关注inode总数。inode总数在格式化的时候就确定了。`
* mount挂载到文件系统

```
inode 和 block 概述
文件是存储在硬盘上的，操作系统读取硬盘的时候，不会一个个扇区地读取，这样效率太低，而是一次性连续读取多个扇区，即一次性读取一个块block。
这种由多个扇区组成的块，是文件存取的最小单位。块的大小，最常见的是4KB，即连续八个sector组成一个block。

文件数据存储在块中，那么还必须找到一个地方存储文件的元信息，比如文件的创建者、文件的创建日期、文件的大小等等。这种存储文件元信息的区域就叫做inode，中文译名为索引节点，也叫i节点。因此，一个文件必须占用一个inode，但至少占用一个block。
```
* block_4KB * 1 = sector_512字节 * 8
* block_存数据 
* inode_存描述数据的数据(元数据)

## inode资源管理
```
特有现象
由于inode号码与文件名分离，导致一些Unix/Linux系统具备以下几种特有的现象。

1.文件名包含特殊字符，可能无法正常删除。这时直接删除inode，能够起到删除文件的作用；

find ./* -inum 节点号 -delete
2.移动文件或重命名文件，只是改变文件名，不影响inode号码；

3.打开一个文件以后，系统就以inode号码来识别这个文件，不再考虑文件名。

这种情况使得软件更新变得简单，可以在不关闭软件的情况下进行更新，不需要重启。因为系统通过inode号码，识别运行中的文件，不通过文件名。更新的时候，新版文件以同样的文件名，生成一个新的inode，不会影响到运行中的文件。等到下一次运行这个软件的时候，文件名就自动指向新版文件，旧版文件的inode则被回收。
```
